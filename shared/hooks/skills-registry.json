{
  "version": "5.0.0",
  "description": "Unified skills registry - single source of truth for skill discovery, relationships, guardrails, auto-approval policies, and background operation rules",
  "background_operations": {
    "sf-testing": {
      "commands": [
        "sf apex run test",
        "sf apex test run"
      ],
      "typical_duration": "2-15 minutes",
      "always_background": true,
      "reason": "Apex tests can run for extended periods depending on org size and test volume"
    },
    "sf-deploy": {
      "commands": [
        "sf project deploy start",
        "sf org create scratch",
        "sf org create sandbox"
      ],
      "typical_duration": "1-10 minutes",
      "background_if_no_wait": true,
      "exclude_patterns": [
        "--dry-run",
        "--validate-only",
        "--check-only"
      ],
      "reason": "Full deployments and org creation are long-running operations"
    },
    "sf-data": {
      "commands": [
        "sf data import tree",
        "sf data import bulk",
        "sf data upsert bulk"
      ],
      "typical_duration": "5-30 minutes",
      "background_if_large": true,
      "large_threshold": "1000 records",
      "reason": "Large data imports can take significant time"
    }
  },
  "guardrails": {
    "dangerous_dml": {
      "patterns": [
        "DELETE FROM \\w+ (;|$)",
        "UPDATE \\w+ SET .* (?<!WHERE.*)$"
      ],
      "severity": "CRITICAL",
      "action": "block",
      "message": "Destructive DML without WHERE clause detected"
    },
    "unbounded_soql": {
      "patterns": [
        "SELECT .* FROM \\w+ (?!.*LIMIT)"
      ],
      "severity": "HIGH",
      "action": "auto_fix",
      "fix": "append LIMIT 200",
      "message": "Unbounded SOQL query - adding LIMIT 200"
    },
    "hardcoded_credentials": {
      "patterns": [
        "(password|api_key|secret|token)\\s*=\\s*['\"][^'\"]+['\"]"
      ],
      "severity": "CRITICAL",
      "action": "block",
      "message": "Hardcoded credentials detected - use Named Credentials"
    },
    "missing_sharing_keyword": {
      "patterns": [
        "public class \\w+(?! (with|without|inherited) sharing)"
      ],
      "severity": "MEDIUM",
      "action": "warn",
      "message": "Consider adding explicit sharing keyword (with sharing recommended)"
    },
    "hardcoded_salesforce_ids": {
      "patterns": [
        "['\"][a-zA-Z0-9]{15}['\"]|['\"][a-zA-Z0-9]{18}['\"]"
      ],
      "severity": "MEDIUM",
      "action": "warn",
      "message": "Hardcoded Salesforce ID detected - consider using Custom Metadata"
    }
  },
  "auto_approve_policy": {
    "description": "Rules for auto-approving Bash command permissions",
    "read_operations": {
      "patterns": [
        "sf data query",
        "sf org display",
        "sf org list",
        "sf project retrieve",
        "sf apex list log",
        "sf apex get log",
        "sf sobject describe",
        "sf org list metadata"
      ],
      "auto_approve": true,
      "reason": "Read-only operations are safe"
    },
    "scratch_org_operations": {
      "patterns": [
        "--target-org.*scratch",
        "--target-org.*dev.*scratch"
      ],
      "auto_approve": true,
      "reason": "Scratch orgs are disposable"
    },
    "validation_deploys": {
      "patterns": [
        "sf project deploy start.*--dry-run",
        "sf project deploy validate"
      ],
      "auto_approve": true,
      "reason": "Dry-run validations don't modify org"
    },
    "require_confirmation": {
      "patterns": [
        "--target-org.*(prod|production)",
        "sf org delete",
        "DELETE FROM",
        "git push.*--force"
      ],
      "auto_approve": false,
      "reason": "Destructive or production operations require confirmation"
    }
  },
  "skills": {
    "sf-apex": {
      "keywords": [
        "apex",
        "trigger",
        "class",
        "test class",
        "batch",
        "queueable",
        "schedulable",
        "invocable",
        "aura enabled",
        "apex controller",
        "selector",
        "domain",
        "service layer",
        "trigger handler",
        "fflib",
        "apex test"
      ],
      "intentPatterns": [
        "create.*apex",
        "write.*trigger",
        "implement.*batch",
        "build.*class",
        "create.*test.*class",
        "add.*method",
        "implement.*interface",
        "fix.*apex",
        "debug.*apex",
        "refactor.*apex",
        "optimize.*apex"
      ],
      "filePatterns": [
        "\\.cls$",
        "\\.trigger$",
        "\\.cls-meta\\.xml$"
      ],
      "priority": "high",
      "description": "Apex code development with validation and best practices"
    },
    "sf-flow": {
      "keywords": [
        "flow",
        "screen flow",
        "record-triggered",
        "record triggered",
        "autolaunched",
        "auto-launched",
        "subflow",
        "scheduled flow",
        "platform event flow",
        "flow builder",
        "flow element",
        "assignment",
        "decision",
        "loop element",
        "get records",
        "create records",
        "update records",
        "delete records"
      ],
      "intentPatterns": [
        "create.*flow",
        "build.*automation",
        "automate.*process",
        "screen.*flow",
        "record.*triggered",
        "scheduled.*trigger",
        "flow.*trigger",
        "update.*flow",
        "fix.*flow",
        "debug.*flow"
      ],
      "filePatterns": [
        "\\.flow-meta\\.xml$",
        "\\.flow$"
      ],
      "priority": "high",
      "description": "Flow Builder automation with validation"
    },
    "sf-lwc": {
      "keywords": [
        "lwc",
        "lightning web component",
        "web component",
        "wire",
        "wire adapter",
        "apex wire",
        "lightning card",
        "lightning button",
        "slds",
        "css",
        "html template",
        "js controller",
        "lightning message service",
        "lms",
        "jest",
        "lwc test"
      ],
      "intentPatterns": [
        "create.*component",
        "build.*lwc",
        "lightning.*component",
        "create.*web.*component",
        "add.*wire",
        "wire.*apex",
        "test.*lwc",
        "jest.*test",
        "style.*component",
        "fix.*lwc"
      ],
      "filePatterns": [
        "lwc/[^/]+/[^/]+\\.(js|html|css)$",
        "\\.js-meta\\.xml$"
      ],
      "priority": "high",
      "description": "Lightning Web Components with SLDS compliance"
    },
    "sf-ai-agentforce-conversationdesign": {
      "keywords": [
        "conversation design",
        "dialog design",
        "persona",
        "utterance",
        "escalation",
        "topic design",
        "instruction writing",
        "guardrails",
        "agent UX",
        "conversation quality",
        "tone",
        "agentforce design"
      ],
      "intentPatterns": [
        "design.*conversation",
        "write.*instruction",
        "create.*persona",
        "improve.*agent.*quality",
        "review.*topic",
        "utterance.*library",
        "escalation.*matrix",
        "agent.*tone",
        "conversation.*flow"
      ],
      "filePatterns": [
        "persona.*\\.md$",
        "utterance.*\\.csv$",
        "escalation.*\\.md$",
        "scorecard.*\\.md$"
      ],
      "priority": "high",
      "description": "Conversation design for Agentforce agents \u2014 personas, topics, instructions, utterances, escalation, guardrails"
    },
    "sf-ai-agentforce": {
      "keywords": [
        "agentforce",
        "agent builder",
        "agent-builder",
        "prompt template",
        "prompt-template",
        "models api",
        "models-api",
        "genai function",
        "genai plugin",
        "lightning type"
      ],
      "intentPatterns": [
        "create.*agent",
        "build.*agent",
        "setup.*agent",
        "prompt.*template",
        "models.*api",
        "genai.*function"
      ],
      "filePatterns": [
        "\\.genAiFunction-meta\\.xml$",
        "\\.genAiPlugin-meta\\.xml$",
        "\\.promptTemplate-meta\\.xml$",
        "\\.lightningTypeBundle-meta\\.xml$"
      ],
      "priority": "medium",
      "description": "Standard Agentforce platform skill for Setup UI agent building, PromptTemplate, Models API, and GenAi metadata"
    },
    "sf-metadata": {
      "keywords": [
        "custom object",
        "custom field",
        "metadata",
        "permission set",
        "profile",
        "page layout",
        "record type",
        "validation rule",
        "formula field",
        "picklist",
        "lookup",
        "master-detail",
        "field-level security",
        "fls",
        "object permissions"
      ],
      "intentPatterns": [
        "create.*object",
        "add.*field",
        "configure.*permissions",
        "new.*custom.*field",
        "setup.*validation",
        "create.*picklist",
        "add.*lookup",
        "create.*master.*detail",
        "setup.*layout"
      ],
      "filePatterns": [
        "\\.object-meta\\.xml$",
        "\\.field-meta\\.xml$",
        "\\.permissionset-meta\\.xml$",
        "\\.profile-meta\\.xml$"
      ],
      "priority": "medium",
      "description": "Salesforce metadata configuration"
    },
    "sf-deploy": {
      "keywords": [
        "deploy",
        "deployment",
        "release",
        "push",
        "sandbox",
        "production",
        "source deploy",
        "metadata deploy",
        "package",
        "changeset",
        "scratch org",
        "ci",
        "cd",
        "pipeline",
        "devops"
      ],
      "intentPatterns": [
        "deploy.*org",
        "release.*production",
        "push.*changes",
        "deploy.*sandbox",
        "create.*package",
        "deploy.*metadata",
        "run.*deployment",
        "validate.*deployment",
        "quick.*deploy"
      ],
      "filePatterns": [],
      "priority": "medium",
      "description": "CI/CD deployment automation"
    },
    "sf-testing": {
      "keywords": [
        "test",
        "coverage",
        "assert",
        "mock",
        "unit test",
        "integration test",
        "apex test",
        "test method",
        "test setup",
        "test factory",
        "code coverage",
        "run tests",
        "test failure"
      ],
      "intentPatterns": [
        "run.*tests",
        "check.*coverage",
        "write.*test",
        "test.*class",
        "increase.*coverage",
        "fix.*test",
        "mock.*data",
        "create.*test.*method",
        "test.*trigger"
      ],
      "filePatterns": [
        ".*Test\\.cls$",
        ".*_Test\\.cls$"
      ],
      "priority": "medium",
      "description": "Test execution and coverage analysis"
    },
    "sf-soql": {
      "keywords": [
        "soql",
        "query",
        "select",
        "where clause",
        "relationship query",
        "aggregate",
        "group by",
        "having",
        "order by",
        "limit",
        "offset",
        "parent-child",
        "child-parent",
        "subquery",
        "sosl",
        "search"
      ],
      "intentPatterns": [
        "write.*query",
        "optimize.*soql",
        "build.*select",
        "query.*records",
        "search.*data",
        "soql.*performance",
        "fix.*query",
        "debug.*soql",
        "create.*subquery"
      ],
      "filePatterns": [
        "\\.soql$"
      ],
      "priority": "medium",
      "description": "SOQL query optimization and analysis"
    },
    "sf-data": {
      "keywords": [
        "test data",
        "data factory",
        "sample data",
        "bulk data",
        "data load",
        "record creation",
        "test records",
        "bulk insert",
        "anonymous apex",
        "data import",
        "dataloader",
        "251 records"
      ],
      "intentPatterns": [
        "create.*test.*data",
        "generate.*data",
        "load.*records",
        "bulk.*insert",
        "sample.*records",
        "factory.*method",
        "setup.*test.*data",
        "create.*251",
        "bulk.*test"
      ],
      "filePatterns": [],
      "priority": "medium",
      "description": "Test data generation and management"
    },
    "sf-integration": {
      "keywords": [
        "callout",
        "http",
        "rest",
        "soap",
        "platform event",
        "cdc",
        "webhook",
        "named credential",
        "external credential",
        "external service",
        "api",
        "endpoint",
        "integration",
        "callback",
        "http request",
        "http response"
      ],
      "intentPatterns": [
        "call.*external",
        "integrate.*api",
        "send.*event",
        "http.*callout",
        "rest.*api",
        "create.*named.*credential",
        "platform.*event",
        "change.*data.*capture",
        "webhook"
      ],
      "filePatterns": [
        "\\.namedCredential-meta\\.xml$",
        "\\.externalCredential-meta\\.xml$",
        "\\.externalServiceRegistration-meta\\.xml$"
      ],
      "priority": "medium",
      "description": "External system integrations"
    },
    "sf-connected-apps": {
      "keywords": [
        "connected app",
        "oauth",
        "jwt",
        "named credential",
        "external credential",
        "client credentials",
        "authorization",
        "token",
        "consumer key",
        "consumer secret",
        "callback url",
        "scopes",
        "pkce",
        "refresh token"
      ],
      "intentPatterns": [
        "configure.*oauth",
        "setup.*authentication",
        "create.*connected",
        "jwt.*bearer",
        "client.*credentials",
        "oauth.*flow",
        "named.*credential",
        "external.*credential"
      ],
      "filePatterns": [
        "\\.connectedApp-meta\\.xml$",
        "\\.eca-meta\\.xml$"
      ],
      "priority": "low",
      "description": "OAuth and authentication configuration"
    },
    "sf-debug": {
      "keywords": [
        "debug",
        "log",
        "trace",
        "troubleshoot",
        "error",
        "exception",
        "stack trace",
        "apex log",
        "debug log",
        "log level",
        "fine",
        "finest",
        "callout",
        "workflow",
        "validation",
        "system debug"
      ],
      "intentPatterns": [
        "debug.*issue",
        "analyze.*log",
        "trace.*execution",
        "fix.*error",
        "troubleshoot.*issue",
        "read.*debug.*log",
        "enable.*debug",
        "check.*exception",
        "find.*error"
      ],
      "filePatterns": [
        "\\.log$",
        "debug.*\\.txt$"
      ],
      "priority": "low",
      "description": "Debug log analysis and troubleshooting"
    },
    "sf-diagram-mermaid": {
      "keywords": [
        "diagram",
        "erd",
        "mermaid",
        "architecture",
        "visualization",
        "data model",
        "entity relationship",
        "sequence diagram",
        "flowchart",
        "class diagram",
        "object diagram",
        "schema",
        "hook lifecycle",
        "flowchart tb",
        "flowchart lr",
        "stateDiagram",
        "gantt",
        "pie chart"
      ],
      "auto_invoke_keywords": [
        "mermaid",
        "flowchart",
        "sequence diagram",
        "erDiagram",
        "class diagram",
        "stateDiagram",
        "gantt",
        "hook lifecycle",
        "architecture diagram"
      ],
      "intentPatterns": [
        "create.*diagram",
        "visualize.*schema",
        "draw.*architecture",
        "generate.*erd",
        "show.*relationships",
        "data.*model.*diagram",
        "sequence.*diagram",
        "architecture.*diagram",
        "mermaid.*diagram",
        "flowchart.*diagram",
        "create.*flowchart",
        "create.*erd"
      ],
      "filePatterns": [
        "diagrams?/.*\\.md$",
        ".*-erd\\.md$",
        ".*-sequence\\.md$",
        ".*-diagram\\.md$"
      ],
      "priority": "low",
      "description": "Mermaid diagram generation"
    },
    "sf-diagram-nanobananapro": {
      "keywords": [
        "mockup",
        "visual",
        "image",
        "erd image",
        "wireframe",
        "ui design",
        "visual erd",
        "png",
        "svg",
        "screenshot",
        "preview",
        "nano banana",
        "nanobananapro",
        "generate image"
      ],
      "auto_invoke_keywords": [
        "image",
        "png",
        "svg",
        "mockup",
        "wireframe",
        "visual erd",
        "nano banana",
        "nanobananapro",
        "visual image",
        "generate image"
      ],
      "intentPatterns": [
        "create.*mockup",
        "generate.*visual",
        "design.*ui",
        "visual.*erd",
        "image.*diagram",
        "wireframe.*component",
        "preview.*design",
        "generate.*image",
        "create.*image",
        "export.*png",
        "export.*svg"
      ],
      "filePatterns": [
        "\\.png$",
        "\\.svg$",
        "\\.jpg$"
      ],
      "priority": "low",
      "description": "Visual mockups and image generation"
    },
    "sf-ai-agentforce-testing": {
      "keywords": [
        "agent test",
        "test spec",
        "agent validation",
        "agentic testing",
        "test case",
        "utterance",
        "expectation",
        "topic routing",
        "action sequence",
        "test definition",
        "agent test run"
      ],
      "intentPatterns": [
        "test.*agent",
        "validate.*agentforce",
        "create.*test.*spec",
        "agent.*test.*case",
        "test.*topic.*routing",
        "verify.*agent",
        "run.*agent.*test"
      ],
      "filePatterns": [
        ".*-test-spec\\.yaml$",
        ".*-test-spec\\.yml$"
      ],
      "priority": "low",
      "description": "Agentforce agent test automation"
    },
    "skill-builder": {
      "keywords": [
        "create skill",
        "new skill",
        "skill template",
        "build skill",
        "skill development",
        "custom skill",
        "plugin",
        "hook development"
      ],
      "intentPatterns": [
        "create.*skill",
        "build.*new.*skill",
        "develop.*plugin",
        "new.*sf.*skill",
        "skill.*template"
      ],
      "filePatterns": [
        "SKILL\\.md$",
        "plugin\\.json$",
        "hooks\\.json$"
      ],
      "priority": "low",
      "description": "Create new sf-skills modules"
    },
    "sf-ai-agentscript": {
      "keywords": [
        "agent script",
        "agentscript",
        "agentforce",
        "agent",
        "topic",
        "action",
        "fsm",
        "state machine",
        "deterministic agent",
        "hybrid reasoning",
        "slot filling",
        "instruction resolution"
      ],
      "intentPatterns": [
        "create.*agent",
        "build.*agentforce",
        "new.*agent",
        "write.*agent.*script",
        "agent.*topic",
        "agent.*action",
        "deterministic.*agent",
        "fsm.*agent"
      ],
      "filePatterns": [
        "\\.agent$",
        "\\.agentDefinition-meta\\.xml$",
        "GenAi.*\\.xml$"
      ],
      "priority": "high",
      "description": "Agent Script DSL for deterministic Agentforce agents"
    },
    "sf-permissions": {
      "keywords": [
        "permission set",
        "permission set group",
        "psg",
        "fls",
        "field level security",
        "object permissions",
        "who has access",
        "permission analyzer",
        "access audit",
        "hierarchy"
      ],
      "intentPatterns": [
        "who.*has.*access",
        "permission.*set",
        "analyze.*permissions",
        "field.*level.*security",
        "audit.*access",
        "permission.*hierarchy",
        "visualize.*permissions",
        "export.*permissions"
      ],
      "filePatterns": [
        "\\.permissionset-meta\\.xml$",
        "\\.permissionsetgroup-meta\\.xml$"
      ],
      "priority": "medium",
      "description": "Permission Set analysis and hierarchy visualization"
    },
    "sf-ai-agentforce-observability": {
      "keywords": [
        "session tracing",
        "stdm",
        "observability",
        "agent session",
        "agentforce analytics",
        "agent debugging",
        "data cloud",
        "parquet",
        "polars",
        "session extraction",
        "agent telemetry"
      ],
      "intentPatterns": [
        "extract.*session",
        "debug.*agent.*session",
        "analyze.*agentforce",
        "session.*tracing",
        "agent.*observability",
        "agent.*analytics",
        "extract.*stdm",
        "session.*data",
        "agent.*telemetry"
      ],
      "filePatterns": [
        "\\.parquet$",
        "stdm_data/"
      ],
      "priority": "medium",
      "description": "Extract and analyze Agentforce session tracing data from Data Cloud"
    }
  }
}
